<?xml version="1.0" encoding="UTF-8"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://axelor.com/xml/ns/object-views
       http://axelor.com/xml/ns/object-views/object-views_5.4.xsd">
       
    <grid model="com.axelor.gst.db.Invoice" title="Invoices" name="invoice-grid">
        <field name="status"/>
        <field name="company"/>
        <field name="reference"/>
        <field name="dates"/>
        <field name="party"/>
        <field name="partyContact"/>
        <field name="invoiceAddress"/>
        <field name="shippingAddress"/>
        <field name="netAmount"/>
        <field name="netIgst"/>
        <field name="netCsgt"/>
        <field name="netSgst"/>
        <field name="grossAmount"/>
    </grid>   
       
    <form model="com.axelor.gst.db.Invoice" title="Invoices" name="invoice-form" onNew="action-onGroup-for-all" width="large">
        <panel title="Invoices" name="invoices">
        <field name="status" showTitle="false" widget="NavSelect" colSpan="12"/>
        <field name="reference" colSpan="12"/>
        <field name="company"/>
        <field name="dates"/>
        <field name="party" onChange="action-onChange-party-update-partyContact"/>
        <field name="partyContact"/>
        <field name="invoiceAddress"/>
        <field name="shippingAddress"/>
        <field name="useInvoiceAddressAsShipping"/>
        <field name="netAmount"/>
        <field name="netIgst"/>
        <field name="netCsgt"/>
        <field name="netSgst"/>
        <field name="grossAmount"/>
          <panel-related field="invoiceItems" colSpan="12"/>
        </panel>
        <panel sidebar="true">
          <button onClick="bttn-to-change-status,bttn-to-change-title" name="clickMeBtn" title="draft" />
        </panel>
        
    </form>
       
       
       <action-group name="action-onGroup-for-all">
          <action name="action-onNew-fill-invoice"/>
          <action name="action-onNew-get-company"/>
       </action-group>
       
       <action-record name="action-onNew-fill-invoice" model="com.axelor.gst.db.Invoice">
         <field name="dates" expr="eval: __datetime__"/>
       </action-record>
      
      <action-record name="action-onNew-get-company" model="com.axelor.gst.db.Invoice" >
           <field name="company" expr="eval: __repo__(Company).all().fetchOne()"/> 
       </action-record>
   
      <action-attrs name="bttn-to-change-status">
          <attribute name="value" for="status" expr="draft" />
          <attribute name="value" for="status" expr="validated" if="status == 'draft'"/>
          <attribute name="value" for="status" expr="paid" if="status == 'validated'"/>
          <attribute name="value" for="status" expr="cancelled" if="status == 'paid'"/>
          <attribute name="value" for="status" expr="draft" if="status == 'cancelled'"/>
      </action-attrs>
      
      <action-attrs name="bttn-to-change-title">
       <!--    <attribute name="title" for="clickMeBtn" expr="draft"/> -->
          <attribute name="title" for="clickMeBtn" expr="validated" if="status == 'draft'"/>
          <attribute name="title" for="clickMeBtn" expr="paid" if="status == 'validated'"/>
          <attribute name="title" for="clickMeBtn" expr="cancelled" if="status == 'paid'"/>
           <attribute name="title" for="clickMeBtn" expr="draft" if="status == 'cancelled'"/>
      </action-attrs>
      
     <action-attrs name="action-onChange-party-update-partyContact">
          <attribute name="value" for="partyContact" expr="eval:__repo__(Contact).all().fetchOne()"/>
     </action-attrs>
       <!-- eval:__config__.app.getTodayDate(__repo__(Company).all().fetchOne())" if="__user__.activeCompany == null &amp;&amp; __repo__(Company).all().fetch().size == 1" -->
 </object-views>      